<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Login / Register - CFi Ideation Team</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms"></script>
<script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#137fec",
            "background-light": "#f6f7f8",
            "background-dark": "#101c22",
          },
          fontFamily: {
            "display": ["Inter"]
          },
          borderRadius: {
            "DEFAULT": "0.25rem",
            "lg": "0.5rem",
            "xl": "0.75rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
<style>
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
  </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-gray-800 dark:text-gray-200">
<div class="flex items-center justify-center min-h-screen p-4">
<div class="w-full max-w-md mx-auto">
<div class="text-center mb-6">
<div class="flex items-center justify-center gap-3">
<img src="/cfi-logo.png" alt="CFi Logo" class="h-8 w-8">
<h2 class="text-xl font-bold text-slate-800 dark:text-white">Administrative Toolkit</h2>
</div>
</div>
<div class="bg-white dark:bg-background-dark dark:border dark:border-gray-700 rounded-xl shadow-lg">
<div class="flex border-b border-gray-200 dark:border-gray-700">
<button class="w-1/2 p-4 text-center font-semibold border-b-2 border-primary text-primary" id="login-tab" onclick="showTab('login')">
Login
</button>
<button class="w-1/2 p-4 text-center font-semibold text-gray-500 dark:text-gray-400 border-b-2 border-transparent hover:text-primary hover:border-primary/50 dark:hover:text-primary" id="register-tab" onclick="showTab('register')">
Register
</button>
</div>
<div class="p-6 md:p-8">
<div class="hidden p-3 mb-4 rounded text-center text-sm" id="message-area"></div>
<div class="tab-content active" id="login">
<form onsubmit="login(event)" class="space-y-6" method="POST">
<div>
<label class="sr-only" for="login-email">Email</label>
<input class="w-full px-4 py-3 bg-background-light dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary focus:border-primary placeholder-gray-500 dark:placeholder-gray-400" id="login-email" name="email" placeholder="Email" required="" type="email"/>
</div>
<div>
<label class="sr-only" for="login-password">Password</label>
<input class="w-full px-4 py-3 bg-background-light dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary focus:border-primary placeholder-gray-500 dark:placeholder-gray-400" id="login-password" name="password" placeholder="Password" required="" type="password"/>
</div>
<div>
<button class="w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary/90 transition duration-300" type="submit">Login</button>
</div>
<div class="text-center mt-4">
<a href="#" onclick="showForgotPassword()" class="text-sm text-primary hover:underline">Forgot Password?</a>
</div>
</form>
</div>
<div class="tab-content" id="register">
<form onsubmit="register(event)" class="space-y-6" method="POST">
<div>
<label class="sr-only" for="register-name">Full Name</label>
<input class="w-full px-4 py-3 bg-background-light dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary focus:border-primary placeholder-gray-500 dark:placeholder-gray-400" id="register-name" name="name" placeholder="Full Name" required="" type="text"/>
</div>
<div>
<label class="sr-only" for="register-email">Email</label>
<input class="w-full px-4 py-3 bg-background-light dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary focus:border-primary placeholder-gray-500 dark:placeholder-gray-400" id="register-email" name="email" placeholder="Email" required="" type="email"/>
</div>
<div>
<label class="sr-only" for="register-password">Password</label>
<input class="w-full px-4 py-3 bg-background-light dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-primary focus:border-primary placeholder-gray-500 dark:placeholder-gray-400" id="register-password" name="password" placeholder="Password" required="" type="password"/>
</div>
<div>
<button class="w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary/90 transition duration-300" type="submit">Register</button>
</div>
</form>
</div>
</div>
</div>
<div class="text-center mt-6">
<a class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary" href="index.html">‚Üê Back to Course Info</a>
</div>
</div>
</div>

<!-- Forgot Password Modal -->
<div id="forgot-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4">
<div class="bg-white dark:bg-background-dark rounded-xl p-6 w-full max-w-md">
<h3 class="text-lg font-bold mb-4">Reset Password</h3>
<form onsubmit="sendResetEmail(event)">
<input type="email" id="reset-email" placeholder="Enter your email" required class="w-full px-4 py-3 mb-4 border rounded-lg">
<div class="flex gap-3">
<button type="button" onclick="closeForgotModal()" class="flex-1 px-4 py-2 border rounded-lg">Cancel</button>
<button type="submit" class="flex-1 px-4 py-2 bg-primary text-white rounded-lg">Send Reset Link</button>
</div>
</form>
</div>
</div>

<script>
    function showTab(tabName) {
      const tabs = document.querySelectorAll('.tab-content');
      tabs.forEach(tab => {
        tab.classList.remove('active');
      });
      const loginTab = document.getElementById('login-tab');
      const registerTab = document.getElementById('register-tab');
      if (tabName === 'login') {
        document.getElementById('login').classList.add('active');
        loginTab.classList.add('border-primary', 'text-primary');
        loginTab.classList.remove('text-gray-500', 'dark:text-gray-400', 'border-transparent');
        registerTab.classList.remove('border-primary', 'text-primary');
        registerTab.classList.add('text-gray-500', 'dark:text-gray-400', 'border-transparent');
      } else {
        document.getElementById('register').classList.add('active');
        registerTab.classList.add('border-primary', 'text-primary');
        registerTab.classList.remove('text-gray-500', 'dark:text-gray-400', 'border-transparent');
        loginTab.classList.remove('border-primary', 'text-primary');
        loginTab.classList.add('text-gray-500', 'dark:text-gray-400', 'border-transparent');
      }
      const messageArea = document.getElementById('message-area');
      messageArea.classList.add('hidden');
      messageArea.textContent = '';
      messageArea.classList.remove('bg-green-100', 'text-green-800', 'dark:bg-green-900', 'dark:text-green-200');
      messageArea.classList.remove('bg-red-100', 'text-red-800', 'dark:bg-red-900', 'dark:text-red-200');
    }
    
    function showMessage(message, type) {
      const messageArea = document.getElementById('message-area');
      messageArea.textContent = message;
      messageArea.classList.remove('hidden');
      if (type === 'success') {
        messageArea.classList.add('bg-green-100', 'text-green-800', 'dark:bg-green-900', 'dark:text-green-200');
        messageArea.classList.remove('bg-red-100', 'text-red-800', 'dark:bg-red-900', 'dark:text-red-200');
      } else if (type === 'error') {
        messageArea.classList.add('bg-red-100', 'text-red-800', 'dark:bg-red-900', 'dark:text-red-200');
        messageArea.classList.remove('bg-green-100', 'text-green-800', 'dark:bg-green-900', 'dark:text-green-200');
      }
    }
    
    // Legacy functions for compatibility
    function showLogin() {
      showTab('login');
    }
    
    function showRegister() {
      showTab('register');
    }
    
    async function login(event) {
        event.preventDefault();
        const form = event.target;
        const email = form.querySelector('input[type="email"]').value;
        const password = form.querySelector('input[type="password"]').value;
        
        try {
            const response = await fetch('/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });
            
            const result = await response.json();
            
            if (result.success) {
                window.location.href = '/dashboard';
            } else {
                showMessage(result.message, 'error');
            }
        } catch (error) {
            showMessage('Login failed. Please try again.', 'error');
        }
    }
    
    async function register(event) {
        event.preventDefault();
        const form = event.target;
        const name = form.querySelector('input[type="text"]').value;
        const email = form.querySelector('input[type="email"]').value;
        const password = form.querySelector('input[type="password"]').value;
        
        try {
            const response = await fetch('/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, email, password })
            });
            
            const result = await response.json();
            
            if (result.success) {
                showMessage('Registration successful! Please login.', 'success');
                showLogin();
                form.reset();
            } else {
                showMessage(result.message, 'error');
            }
        } catch (error) {
            showMessage('Registration failed. Please try again.', 'error');
        }
    }
    
    function showForgotPassword() {
        document.getElementById('forgot-modal').classList.remove('hidden');
        document.getElementById('forgot-modal').classList.add('flex');
    }
    
    function closeForgotModal() {
        document.getElementById('forgot-modal').classList.add('hidden');
        document.getElementById('forgot-modal').classList.remove('flex');
    }
    
    async function sendResetEmail(event) {
        event.preventDefault();
        const email = document.getElementById('reset-email').value;
        
        try {
            const response = await fetch('/forgot-password', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email })
            });
            
            const result = await response.json();
            
            if (result.success) {
                showMessage('Password reset email sent! Check your inbox.', 'success');
                closeForgotModal();
            } else {
                showMessage(result.message, 'error');
            }
        } catch (error) {
            showMessage('Error sending reset email', 'error');
        }
    }
  </script>

</body>
</html>